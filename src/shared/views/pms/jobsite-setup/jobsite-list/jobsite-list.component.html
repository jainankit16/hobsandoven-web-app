<!-- Jobsite List Data tab view Start -->
<ngb-accordion #acc="ngbAccordion" activeIds="listJobSites, selectedJobsite" *ngIf="jobsiteLocations != []" [destroyOnHide]="false">
    <ngb-panel id="listJobSites" title="List of all available Jobsites">
        <ng-template ngbPanelContent>
            <div class="container">
                <ngb-tabset [justify]="currentJustify" type="pills" (tabChange)="selectJobLocation($event.nextId)">
                    <!--Filter Tab Configuration template  -->
                    <ngb-tab id="Active">
                        <ng-template ngbTabTitle>
                            <b>Active</b>
                        </ng-template>
                        <ng-template ngbTabContent>
                        </ng-template>
                    </ngb-tab>
                    <ngb-tab id="Passive">
                        <ng-template ngbTabTitle>
                            <b>Passive</b>
                        </ng-template>
                        <ng-template ngbTabContent>
                        </ng-template>
                    </ngb-tab>
                    <ngb-tab id="Archieved">
                        <ng-template ngbTabTitle>
                            <b>Archived</b>
                        </ng-template>
                        <ng-template ngbTabContent>
                        </ng-template>
                    </ngb-tab>
                    <ngb-tab id="All">
                        <ng-template ngbTabTitle>
                            <b>All</b>
                        </ng-template>
                        <ng-template ngbTabContent>
                        </ng-template>
                    </ngb-tab>
                </ngb-tabset>
                <!-- Data Table Strat from here -->
                <div class="m-t-10" *ngIf="!errorMessage">
                    <ngx-datatable #myTable class="material striped vScroll" [ngClass]="tableData.length < 8 ? 'ngxHasData' : ''" [rows]="tableData"
                        [loadingIndicator]="loadingIndicator" [columnMode]="'standard'" [limit]="itemsPerPage" [headerHeight]="50"
                        [footerHeight]="50" [rowHeight]="60" [scrollbarH]="true">
                        <ngx-datatable-column name="Edit" [width]="80">
                            <ng-template let-row="row" ngx-datatable-cell-template>
                                <p #btnElement (click)="openDetailPage(jobsitedetail,'xl',row, btnElement)" class="pointer text-primary">Edit</p>
                            </ng-template>
                        </ngx-datatable-column>
                        <ngx-datatable-column name="Program #" [width]="150">
                            <ng-template ngx-datatable-cell-template>
                                {{programID}}
                            </ng-template>
                        </ngx-datatable-column>
                        <ngx-datatable-column name="Jobsite #" prop="Jobsite_ID__c" [width]="150"></ngx-datatable-column>
                        <ngx-datatable-column name="Country" prop="Country__c" [width]="150"></ngx-datatable-column>
                        <ngx-datatable-column name="City" prop="City__c" [width]="150"></ngx-datatable-column>
                        <ngx-datatable-column name="Address" prop="Street__c" [width]="150"></ngx-datatable-column>
                        <ngx-datatable-column name="Service Zone" prop="GeoMetro.Name" [width]="150">
                            <ng-template let-row="row" ngx-datatable-cell-template>
                                <span> {{row?.GeoMetro?.Name}} </span>
                            </ng-template>
                        </ngx-datatable-column>
                        <ngx-datatable-footer>
                            <ng-template ngx-datatable-footer-template let-rowCount="rowCount" let-pageSize="pageSize" let-selectedCount="selectedCount"
                                let-curPage="curPage" let-offset="offset">
                                <div style="padding: 5px 10px; width: 100px;">
                                    <div>
                                        Total: {{rowCount}}
                                    </div>
                                </div>
                                <datatable-pager [pagerLeftArrowIcon]="'datatable-icon-left'" [pagerRightArrowIcon]="'datatable-icon-right'" [pagerPreviousIcon]="'datatable-icon-prev'"
                                    [pagerNextIcon]="'datatable-icon-skip'" [page]="curPage" [size]="pageSize" [count]="rowCount"
                                    [hidden]="!((rowCount / pageSize) > 1)" (change)="myTable.onFooterPage($event)">
                                </datatable-pager>
                                <div style="padding: 5px 10px" [hidden]="!((rowCount / pageSize) > 1) || noRecords">
                                    <div>
                                        <button class="btn btn-sm" (click)="loadMoreRecords()">Load More</button>
                                    </div>
                                </div>
                            </ng-template>
                        </ngx-datatable-footer>
                    </ngx-datatable>
                </div>
                <div *ngIf="errorMessage" class="alert alert-warning m-t-5">
                    {{errorMessage}}
                </div>
            </div>
        </ng-template>
    </ngb-panel>
    <br>
</ngb-accordion>
<!-- Jobsite List Data tab view End -->

<!-- Jobsite detail expanded view modal Start-->
<ng-template #jobsitedetail let-c="close" let-d="dismiss">
    <div class="modal-header ">
        <h4 class="modal-title">Manage Jobsite</h4>
        <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body scroll-vertical740">
        <jobsite-detail [jobsite]="contentData" (listObjChanged)="this.loadJobsiteData(0)"></jobsite-detail>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="c('Close click')">Close</button>
    </div>
</ng-template>

<!-- Jobsite expanded view modal -->
<ng-template #expandedViewTemplate let-c="close" let-d="dismiss">
    <div class="modal-header ">
        <h4 class="modal-title">Selected Jobsite</h4>
        <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body scroll-vertical740">
        <div class="col-md-12">
            <div class="table-responsive">
                <table class="table color-table info-table">
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>Program #</th>
                            <th>Jobsite #</th>
                            <th>Jobsite Name</th>
                            <th>Country</th>
                            <th>State</th>
                            <th>Zip</th>
                            <th>City</th>
                            <th>Street</th>
                            <th>Job Description</th>
                            <th>Service Zone</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let jobLoc of selectedJobsite, let i = index">
                            <td>{{i +1}}</td>
                            <td>{{programID}}</td>
                            <td>{{jobLoc.Jobsite?.Jobsite_ID__c}}</td>
                            <td>{{jobLoc.Jobsite?.Name}}</td>
                            <td>{{jobLoc.Jobsite?.Country__c}}</td>
                            <td>{{jobLoc.Jobsite?.State__c}}</td>
                            <td>{{jobLoc.Jobsite?.Zip__c}}</td>
                            <td>{{jobLoc.Jobsite?.City__c}}</td>
                            <td>{{jobLoc.Jobsite?.Street__c}}</td>
                            <td>{{jobLoc.Jobsite?.Jobsite_Description__c}}</td>
                            <td>{{jobLoc.Jobsite?.GeoMetro?.Name}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-default mRight" (click)="exportToCsv()">Export</button>
        <button type="button" class="btn btn-default" (click)="c('Close click')">Close</button>
    </div>
</ng-template>
<!-- Jobsite expanded view modal Ends -->